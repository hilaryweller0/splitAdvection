#LyX 2.0 created this file. For more info see http://www.lyx.org/
\lyxformat 413
\begin_document
\begin_header
\textclass article
\begin_preamble
\newcommand{\nicefrac}[2]{\ensuremath ^{#1}\!\!/\!_{#2}}
\usepackage { fancybox}
\usepackage[export]{adjustbox}

\renewcommand{\floatpagefraction}{0.95}
\renewcommand{\textfraction}{0}
\renewcommand{\topfraction}{1}
\renewcommand{\bottomfraction}{1}

%\RequirePackage{tweaklist}
%\renewcommand{\itemhook}
%{
%    \setlength{\topsep}{3pt}
%    \setlength{\parskip}{0pt}
%    \setlength{\parsep}{0pt}
%    \setlength{\partopsep}{0pt}
%    \setlength{\itemsep}{0pt}
%    \setlength{\labelwidth}{10pt}
%    \setlength{\leftmargin}{\labelwidth}
%}

%\renewcommand{\enumhook}
%{
%    \setlength{\topsep}{3pt}
%    \setlength{\parskip}{0pt}
%    \setlength{\parsep}{0pt}
%    \setlength{\partopsep}{0pt}
%    \setlength{\itemsep}{3pt}
%    \setlength{\labelwidth}{10pt}
%    \setlength{\leftmargin}{\labelwidth}
%}

%\renewcommand{\descriptionlabel}[1]{\parbox{\leftmargin}{\raggedleft #1.~}}
% Added by lyx2lyx
% Added by lyx2lyx
\usepackage{amssymb}
\end_preamble
\use_default_options false
\maintain_unincluded_children false
\language british
\language_package default
\inputencoding auto
\fontencoding global
\font_roman times
\font_sans default
\font_typewriter default
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100
\font_tt_scale 100

\graphics default
\default_output_format pdf5
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize 12
\spacing single
\use_hyperref false
\papersize a4paper
\use_geometry true
\use_amsmath 1
\use_esint 1
\use_mhchem 1
\use_mathdots 1
\cite_engine natbib_authoryear
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\use_refstyle 0
\index Index
\shortcut idx
\color #008000
\end_index
\paperwidth 15cm
\paperheight 12cm
\leftmargin 2.5cm
\topmargin 2.5cm
\rightmargin 2.5cm
\bottommargin 2.5cm
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\quotes_language english
\papercolumns 1
\papersides 1
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Title
Dimension Splitting Errors in Atmospheric Transport
\end_layout

\begin_layout Author
Yumeng Chen, Hilary Weller and James Shaw
\end_layout

\begin_layout Section
Introduction
\end_layout

\begin_layout Standard
Dimensionally split schemes are attractive for atmospheric modelling due
 to their high accuracy in each spatial dimension and efficiency, operating
 in each dimension separately 
\begin_inset CommandInset citation
LatexCommand citep
before "eg. "
key "LR96,LLM96,BS99,PL07,KNK15"

\end_inset

.
 Inherent conservation and accurate long time steps can also be achieved
 without remapping by using the flux form semi-Lagrangian (FFSL or forward
 in time) technique 
\begin_inset CommandInset citation
LatexCommand citep
after "and EN14"
before "eg. "
key "Smo82,CW84"

\end_inset

 which integrates the dependent variable over a swept volume upstream of
 every face in order to calculate fluxes in and out of cells.
 One-dimensional single stage, FFSL schemes can be combined to achieve second
 order accuracy, conservation and preservation of constants in multi-dimensions
 by using COSMIC splitting 
\begin_inset CommandInset citation
LatexCommand citep
key "LLM96"

\end_inset

 which combines advective form and flux form updates in each direction in
 order to eliminate conservation and constancy preservation errors.
 Dimensionally split schemes have even found to give good accuracy on non-orthog
onal grids such as the cubed sphere 
\begin_inset CommandInset citation
LatexCommand citep
key "PL07,KNK15"

\end_inset

.
 However on non-orthongal grids, dimensionally split schemes do not account
 properly for non-orthogonality and first-order errors will inevitably occur.
\end_layout

\begin_layout Standard
First-order errors on non-orthogonal grids can be eliminated by using genuinely
 multi-dimensional advection schemes.
 These can be either FFSL 
\begin_inset CommandInset citation
LatexCommand citep
before "eg."
key "Las02,LR05b,Miu07b,TCD14"

\end_inset

, method of lines 
\begin_inset CommandInset citation
LatexCommand citep
before "MOL, discretising space and time separetely, eg."
key "WWF09,SG11,WS14"

\end_inset

 or semi-Lagrangian with conservative re-mapping 
\begin_inset CommandInset citation
LatexCommand citep
key "IK04,LNU10,ZWS04"

\end_inset

.
 However the FFSL and MOL multi-dimensional schemes have not been extended
 to work with Courant numbers significantly larger than one.
 FFSL multi-dimensional schemes could be extended to handle large time-steps
 by integrating the upstream swept volume over a large upstream volume,
 interacting with a large number of upstream cells.
 However the cost would be proportional to to time-step since the larger
 the Courant number, the more cells the upstream swept volume would have
 to overlap with.
 This technique therefore offers no advantage over using a smaller time-step.
 MOL multi-dimensional schemes could be extended to work with Courant numbers
 larger than one by using implicit time-stepping.
 This would increase the computational cost per tracer advected since the
 solution of a matrix equation would be needed for every advected tracer
 (although common pre-conditioners could be used, enabling multi-tracer
 efficiency).
 The other disadvantage of implicit time-stepping is the large phase errors
 when long time-steps are used in contrast to semi-Lagrangian or FFSL schemes
 which maintain accuracy with long time-steps.
 Conservative semi-Lagrangian naturally extends to long time-steps but the
 conservative remapping is complicated and expensive, particularly on non-rectan
gular grids.
 
\end_layout

\begin_layout Standard
It is therefore not clear what approach should be taken for achieving long
 time-steps advecting multiple tracers on non-orthogonal grids.
 In this paper, we show the affect of the first order errors of dimensionally
 split FFSL scheme on a number of test-cases which use non-orthogonal grids
 and compare with a genuinely multi-dimensional MOL scheme.
 
\end_layout

\begin_layout Section
Transport Schemes
\end_layout

\begin_layout Subsection
Dimensionally Split Flux-Form Semi-Lagrangian (FFSL) Scheme
\end_layout

\begin_layout Standard
\begin_inset CommandInset include
LatexCommand input
filename "PPM.tex"

\end_inset


\end_layout

\begin_layout Subsection
Multi-dimensional Method of Lines (MOL) Scheme
\end_layout

\begin_layout Standard
The numerical model uses a method of lines, finite volume advection scheme
 written using OpenFOAM.
 This involves a cubic upwind spatial discretisation 
\begin_inset CommandInset citation
LatexCommand citep
key "WS14"

\end_inset

 combined with Crank-Nicholson in time.
 Although the interpolation uses a cubic polynomial, cell centre values
 are approximated as cell average values and face centre values are approximated
 as face average values so the method is formally limited to 2nd order in
 space.
 The finite volume advection scheme using Gauss's divergence theorem to
 approximate the divergece term of the advection equation:
\begin_inset Formula 
\begin{equation}
\nabla\cdot\mathbf{u}\phi=\frac{1}{V}\sum_{f\in c}\phi_{f}\mathbf{u}_{f}\cdot\mathbf{S}_{f}
\end{equation}

\end_inset

where 
\begin_inset Formula $V$
\end_inset

 is the cell volume, the summation is over all faces, 
\begin_inset Formula $f$
\end_inset

, of cell 
\begin_inset Formula $c$
\end_inset

, 
\begin_inset Formula $\phi_{f}$
\end_inset

 is the value of the tracer, 
\begin_inset Formula $\phi$
\end_inset

 interpolated onto face 
\begin_inset Formula $f$
\end_inset

, 
\begin_inset Formula $\mathbf{u}_{f}$
\end_inset

 is the velocity on face 
\begin_inset Formula $f$
\end_inset

 and 
\begin_inset Formula $\mathbf{S}_{f}$
\end_inset

 is the vector normal to face 
\begin_inset Formula $f$
\end_inset

 with magnitude equal to the area of face 
\begin_inset Formula $f$
\end_inset

 (ie the face area vector).
 The advection scheme uses a fit to a 2d (or 3d) polynomial using an upwind-bias
ed stencil of cells (fig 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:stencil"

\end_inset

) in order to interpolate from known cell values onto a face.
 In 2d, the cubic polynomial is:
\lang english

\begin_inset Formula 
\begin{equation}
\phi=a+bx+cy+dx^{2}+exy+fy^{2}+gx^{3}+hx^{2}y+ixy^{2}
\end{equation}

\end_inset

omitting terms in 
\begin_inset Formula $y^{3}$
\end_inset

, where 
\begin_inset Formula $x$
\end_inset

 is the direction normal to a cell face and 
\begin_inset Formula $y$
\end_inset

 is perpendicular to 
\begin_inset Formula $x$
\end_inset

.
 Coefficients 
\begin_inset Formula $a$
\end_inset

 to 
\begin_inset Formula $i$
\end_inset

 are set from a least squares fit to the cell data in the stencil.
 The least-squares problem involves a 
\begin_inset Formula $9\times m$
\end_inset

 matrix singular value decomposition for every face where 
\begin_inset Formula $m$
\end_inset

 is the size of the stencil.
 However this is purely a geometric calculation and is therefore a pre-processin
g activity since the grid is fixed.
 This generates a set of weights for calculating 
\begin_inset Formula $\phi_{f}$
\end_inset

 from the cell values in the stencil, leaving 
\begin_inset Formula $m$
\end_inset

 multiplies for each face for each call of the advection operator.
 The stencils are found for three-dimensional, arbitrarily structured grids
 by finding the face(s) closest to upwind of the face we are interpolating
 onto, taking the two cells either side of the upwind face(s) and then taking
 the vertex neighbours of those central cells (fig 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:stencil"

\end_inset

).
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset External
	template XFig
	filename figs/cubicUpCPCstencil.fig
	scale 50

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Stencil of upwind-biased cells for interpolating onto face 
\begin_inset Formula $F$
\end_inset

 using a 2d cubic polynomial
\begin_inset CommandInset label
LatexCommand label
name "fig:stencil"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
In order to ensure that the fit is accurate in the cells either side of
 face 
\begin_inset Formula $f$
\end_inset

 and to ensure that the values in these adjacent cells have the strongest
 control over 
\begin_inset Formula $\phi_{f}$
\end_inset

, rows associated with these values in the least squares fit matrix are
 weighted a factor of 1000 relative to the other rows.
 This does not affect the order of accuracy.
 The value 
\begin_inset Formula $\phi_{f}$
\end_inset

 is then calculated as a higher-order correction to first-order upwind:
 
\begin_inset Formula 
\begin{equation}
\phi_{f}=\phi_{\text{up}}+\sum_{c}w_{c}\phi_{c}
\end{equation}

\end_inset

where 
\begin_inset Formula $w_{c}$
\end_inset

 are the weights for each cell of the stencil calculated from the least
 squares fit, with 
\begin_inset Formula $w_{\text{up}}$
\end_inset

 reduced by 1 to make the fit a correction on upwind.
 
\end_layout

\begin_layout Standard
In order to reduce the matrix size for the Crank-Nicholson time-stepping,
 a first-order upwind spatial discretisation is used for the implicit solution
 and the higher-order contribution is a deferred correction.
 This means that two implicit solves are used per time-step so that the
 higher-order terms are solved to second-order in time.
 Consequently, assuming that the velocity field and mesh are constant in
 time, the time-stepping scheme is defined as:
\begin_inset Formula 
\begin{eqnarray}
\frac{\phi^{\prime}-\phi^{n}}{\Delta t} & = & -\frac{1}{2V}\sum_{f\in c}\left(\phi_{\text{up}}^{n}+\phi_{\text{up}}^{\prime}+2\sum_{c}w_{c}\phi_{c}^{n}\right)\mathbf{u}_{f}\cdot\mathbf{S}_{f}\\
\frac{\phi^{n+1}-\phi^{n}}{\Delta t} & = & -\frac{1}{2V}\sum_{f\in c}\left(\phi_{\text{up}}^{n}+\phi_{\text{up}}^{n+1}+\sum_{c}w_{c}\phi_{c}^{n}+\sum_{c}w_{c}\phi_{c}^{\prime}\right)\mathbf{u}_{f}\cdot\mathbf{S}_{f}.
\end{eqnarray}

\end_inset


\end_layout

\begin_layout Section
Coordinate Systems and Grids on a Plane
\end_layout

\begin_layout Standard
In order to use test cases as simple as possible, without the need for incorpora
ting spherical geometry, our computational domain consists of a periodic
 two-dimensional plane with deformations in the coordinate system (or grid)
 mimicking the kind of distortions which are produced by a cubed-sphere
 grid or by terrain following coordinates over orography.
 
\end_layout

\begin_layout Section
Results of Test Cases
\end_layout

\begin_layout Standard
A range of test cases are undertaken on uniform and on distorted grids using
 the dimensionally split scheme and the multi-dimensional scheme in order
 to evaluate the influences of grid distortions and the validity of using
 a dimenisonally split scheme on a distorted grid.
 
\end_layout

\begin_layout Subsection
Solid Body Rotation
\end_layout

\begin_layout Standard
The solid body rotation test case of 
\begin_inset CommandInset citation
LatexCommand citet
key "LLM96"

\end_inset

 is used to compare the accuracy of the dimensionally split and multi-dimensiona
l schemes on orthogonal and non-orthogonal grids.
 We define this test case on a domain 
\begin_inset Formula $10^{4}\times10^{4}\text{ m}^{2}$
\end_inset

.
 The velocity is defined by numerically integrating the streamfunction which
 can be defined at grid vertices by: 
\begin_inset Formula 
\begin{equation}
\psi(x,y,t)=A|\mathbf{x}-\mathbf{x}_{c}|^{2}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{x}_{c}$
\end_inset

 is the centre of the domain, and 
\begin_inset Formula $A=5\pi/3000\text{ s}^{-1}$
\end_inset

 so that the angular velocity is 
\begin_inset Formula $2A$
\end_inset

.
 The initial tracer distribution takes a Gaussian distribution in order
 to ensure that all advection schemes achieve their theoretical order of
 accuracy:
\begin_inset Formula 
\begin{equation}
\phi(\mathbf{x})=\exp\left(-\frac{1}{2}\frac{|\mathbf{x}-\mathbf{x}_{\phi}|^{2}}{r_{\phi}^{2}}\right)\label{eq:7}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{x}_{\phi}=\mathbf{x}_{c}+r_{c\phi}\mathbf{j}$
\end_inset

 is the initial centre of the tracer distribution, 
\begin_inset Formula $r_{c\phi}=2500\text{ m}$
\end_inset

 and 
\begin_inset Formula $r_{\phi}=500\text{ m}$
\end_inset

.
 The analytic solution has the same tracer distribution but with the centre
 of the tracer at: 
\begin_inset Formula 
\begin{equation}
\mathbf{x}_{\phi}=\mathbf{x}_{c}+r_{c\phi}\left(\begin{array}{c}
\cos(\pi/2+2At)\\
\sin(\pi/2+2At)
\end{array}\right)
\end{equation}

\end_inset

and the Gaussian rotates exactly one revolution in 
\begin_inset Formula $600\text{ s}$
\end_inset

.
\end_layout

\begin_layout Standard
Results of this test case on an orthogonal grid of 
\begin_inset Formula $100\times100$
\end_inset

 cells with 
\begin_inset Formula $\Delta t=1\text{ s}$
\end_inset

 are shown in figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:solidBody"

\end_inset

 for both advection schemes.
 The contours show the tracer value every 100 seconds and the colours show
 the errors summed every 100 seconds.
 On an orthogonal grid, the dimensionally split scheme outperforms the multi-dim
ensional scheme.
 The errors nearly disappear within the first 
\begin_inset Formula $300$
\end_inset

 s, while small errors show at the centre of the Gaussian as errors gradually
 increase with time.
 The multi-dimensional scheme shows larger error than dimensionally split
 scheme, where the phase of the Gaussian slightly lags behind the analytical
 solution.
 The errors are a representation of the higher order of accuracy of dimensionall
y split scheme than multi-dimensional scheme on orthogonal grids when the
 Courant number is less than one.
 
\color red
Description of the results blah blah blah.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="2">
<features tabularvalignment="middle">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Orthogonal, dimensionally split scheme
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Non-orthogonal, dimensionally split scheme
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Graphics
	filename YumengsGraphics/solidBodyRotationOnPlane_orthogonal_100x100_dt_1_Tcontours.pdf
	lyxscale 50
	width 49text%

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Graphics
	filename YumengsGraphics/solidBodyRotationOnPlane_nonOrthog_100x100_dt_1_Tcontours.pdf
	lyxscale 50
	width 49text%

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Orthogonal, multi-dimensional scheme
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Non-orthogonal, multi-dimensional scheme
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Graphics
	filename HilarysGraphics/solidBodyRotationOnPlane_orthogonal_100x100_dt_1_Tcontours.pdf
	lyxscale 50
	width 49text%

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Graphics
	filename HilarysGraphics/solidBodyRotationOnPlane_nonOrthog_100x100_dt_1_Tcontours.pdf
	lyxscale 50
	width 49text%

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell multicolumn="1" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Graphics
	filename HilarysGraphics/solidBodyRotationOnPlane_legends_Tdiff.eps
	width 90line%

\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Results of the solid body rotation test case on orthogonal and non-orthogonal
 grids every 100 seconds for grids of 
\begin_inset Formula $100\times100$
\end_inset

 cells and 
\begin_inset Formula $\Delta t=1\text{ s}$
\end_inset

 giving a maximum Courant number of around 1.
 The contours show the tracer value from 0.1 every 0.1 to 0.9 and the colours
 show the errors.
 The dashed contour shows the initial conditions.
 
\begin_inset CommandInset label
LatexCommand label
name "fig:solidBody"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The solid body rotation test case is also performed on a non-orthogonal
 grid on a plane with non-orthogonality similar to that of a cubed-sphere
 grid.
 For the dimensionally split scheme this is achieved using the co-ordinate
 transform:
\begin_inset Formula 
\begin{equation}
\begin{array}{ccc}
X=x &  & Y=\begin{cases}
y_{m}\left(1+\frac{y_{c}-f}{2y_{m}-f}\right) & \text{ for }y\ge f\\
y_{m}\left(1+\frac{y_{c}-f}{f}\right) & \text{ for }y<f
\end{cases}\end{array}
\end{equation}

\end_inset

where 
\begin_inset Formula $y_{c}$
\end_inset

 is the computational domain, 
\begin_inset Formula $y_{m}=5000\text{ m}$
\end_inset

 and 
\begin_inset Formula $f$
\end_inset

 is the equation for a 
\begin_inset Formula $y$
\end_inset

 position of uniform 
\begin_inset Formula $Y$
\end_inset

 half way up the domain.
 In order give angles of 
\begin_inset Formula $120^{o}$
\end_inset

 in the mesh, similar to a cubed sphere, 
\begin_inset Formula $f$
\end_inset

 is given by:
\begin_inset Formula 
\begin{equation}
f=\begin{cases}
y_{m}\left(1+\frac{1}{2\sqrt{3}}\right)-\frac{x}{\sqrt{3}} & \text{ for }x\le x_{m}\\
y_{m}\left(1-\frac{1}{2\sqrt{3}}\right)-\frac{x-x_{m}}{\sqrt{3}} & \text{ for }x>x_{m}
\end{cases}.
\end{equation}

\end_inset

where 
\begin_inset Formula $x_{m}=5000$
\end_inset

 m.
 
\end_layout

\begin_layout Standard
This gives the 
\begin_inset Formula $x$
\end_inset

 and 
\begin_inset Formula $y$
\end_inset

 coordinate locations as shown in figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:cubedGrid"

\end_inset

.
 The multi-dimensional scheme model uses Cartesian coordinates and a distorted
 mesh rather than a non-orthogonal coordinate system on a Cartesian grid.
 However this does not affect the numerical results.
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename HilarysGraphics/solidBodyRotationOnPlane_nonOrthog_50x50_analytic_constant_mesh.pdf
	lyxscale 80
	width 80text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Grid on a plane designed to have similar angles to a cubed-sphere grid.
 
\begin_inset Formula $50\times50$
\end_inset

 grid points and angles up to 
\begin_inset Formula $120^{o}$
\end_inset

.
\begin_inset CommandInset label
LatexCommand label
name "fig:cubedGrid"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The results of the dimensionally split and multi-dimensional schemes on
 the non-orthognal grid are also shown in figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:solidBody"

\end_inset

.
 Although the dimensionally split scheme is still stable, it has much larger
 errors than multi-dimensional schemes on the non-orthogonal grid.
 The Gaussian is stretched along the wind direction using dimensionally
 split scheme because the dimensionally split scheme cannot capture the
 velocity change on the non-orthogonal grid.
 However, the multi-dimensional scheme has a similar error on the non-orthogonal
 grid to on the orthogonal grid due to the accurate representation on both
 grids.
 
\color red
Description of the results blah blah blah.
\end_layout

\begin_layout Standard
The multi-dimensional and dimensionally split schemes take very different
 approaches to handling large Courant numbers.
 The multi-dimensional scheme uses implicit time-stepping whereas the dimensiona
lly split scheme uses a flux-form semi-Lagrangian approach, integrating
 over a line of cells in order to calculate the flux across a face.
 It is well known that implicit schemes suffer from phase errors for long
 time-steps whereas the accuracy semi-Lagrangian approaches is less sensitive
 to the time-step.
 Therefore we present results of both schemes on orthogonal and non-orthogonal
 grids for time-steps 10 times those used in figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:solidBody"

\end_inset

 (
\begin_inset Formula $\Delta t=10\text{ s}$
\end_inset

) giving maximum Courant nubmers of around 10 using 
\begin_inset Formula $100\times100$
\end_inset

 cells in figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:solidBody-dt10"

\end_inset

.
 The error of multi-dimensional scheme is much larger than dimensionally
 split scheme on the orthogonal grid, even if the Courant number is larger
 than one.
 However, the dimensionally split scheme goes unstable on the non-orthogonal
 grid, but the multi-dimensional scheme still hold the similar accuracy
 as on the orthogonal grid though the phase erro is obvious.
 The unstable solution is mainly because the dimensionally scheme cannot
 rightfully represent the inflow and outflow in each cell such that the
 CFL criteria cannot be satisfied.
 Both the results of multi-dimensional scheme and dimensionally split scheme
 with larger time-steps differ significantly from small time-steps.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="2">
<features tabularvalignment="middle">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Orthogonal, dimensionally split scheme
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Non-orthogonal, dimensionally split scheme
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Graphics
	filename YumengsGraphics/solidBodyRotationOnPlane_orthogonal_100x100_dt_10_TcontoursBig.pdf
	lyxscale 50
	width 49text%

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Graphics
	filename YumengsGraphics/solidBodyRotationOnPlane_nonOrthog_100x100_dt_10_TcontoursBig.pdf
	lyxscale 50
	width 49text%

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Orthogonal, multi-dimensional scheme
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Non-orthogonal, multi-dimensional scheme
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Graphics
	filename HilarysGraphics/solidBodyRotationOnPlane_orthogonal_100x100_dt_10_TcontoursBig.pdf
	lyxscale 50
	width 49text%

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Graphics
	filename HilarysGraphics/solidBodyRotationOnPlane_nonOrthog_100x100_dt_10_TcontoursBig.pdf
	lyxscale 50
	width 49text%

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell multicolumn="1" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Graphics
	filename HilarysGraphics/solidBodyRotationOnPlane_legends_TdiffBig_Tdiff.eps
	width 90line%

\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Results of the solid body rotation test case on orthogonal and non-orthogonal
 grids every 100 seconds for grids of 
\begin_inset Formula $100\times100$
\end_inset

 cells and 
\begin_inset Formula $\Delta t=10\text{ s}$
\end_inset

 giving a maximum Courant number of around 10.
 The contours show the tracer value from 0.1 every 0.1 to 0.9 and the colours
 show the errors.
 The dashed contour shows the initial conditions.
 
\begin_inset CommandInset label
LatexCommand label
name "fig:solidBody-dt10"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
We present the convergence with resolution of the 
\begin_inset Formula $\ell_{2}$
\end_inset

 and 
\begin_inset Formula $\ell_{\infty}$
\end_inset

 error measures for grids of 
\begin_inset Formula $50\times50$
\end_inset

, 
\begin_inset Formula $100\times100$
\end_inset

, 
\begin_inset Formula $200\times200$
\end_inset

 and 
\begin_inset Formula $400\times400$
\end_inset

 cells with time-steps scaled in order to maintain the same Courant numbers
 (
\begin_inset Formula $\Delta t=2,\ 1,\ 0.5,\ 0.25\text{ s}$
\end_inset

 to achieve a maximum Courant number of 1 and 10 times these values for
 a maximum Courant number of 10) in figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:solidBodyConverge"

\end_inset

.
 On both orthogonal and non-orthogonal grids, the multi-dimensional scheme
 has second order of convergence with small Courant numbers but first order
 convergent rate with large Courant number.
 Hence, the order of accuracy of multi-dimensional scheme is only affected
 by the Courant number.
 With large Courant number, the multi-dimensional scheme becomes less accurate
 due to large phase error.
 Different from multi-dimensional scheme, dimensionally split scheme is
 affected by both the Courant number and the orthogonality of the grids.
 On the orthogonal grids, the dimensionally split scheme has third order
 accuracy and lowest error when the Courant number less than one, while
 it is less accurate and has only second order accuracy with a much larger
 Courant number.
 On the non-orthogonal grid, the dimensionally split scheme reduce to less
 than first order of accuracy with small Courant number while goes unstable
 with large Courant number.
 Generally, dimensionally split scheme can accurately get the numerical
 solution on orthogonal grids regardless of the Courant number, whereas
 the multi-dimensional scheme has similar behavior on both the orthogonal
 grid and the non-orthogonal grid, which is worse than the dimensionally
 scheme on orthogonal grid but much better than it on non-orthogonal grid.
 However, on the orthogonal grid with small Courant number, the multi-dimensiona
l scheme is more accurate when finer resolution is used due to higher order
 of accuracy.
 
\color red
Description of the results blah blah blah.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="1">
<features tabularvalignment="middle">
<column alignment="center" valignment="top" width="0">
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\ell_{2}$
\end_inset

 errors
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Graphics
	filename HilarysGraphics/solidBodyRotationOnPlane_l2errors.eps
	lyxscale 80
	width 80text%

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\ell_{\infty}$
\end_inset

 errors
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Graphics
	filename HilarysGraphics/solidBodyRotationOnPlane_linferrors.eps
	lyxscale 80
	width 80text%

\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Convergence with resolution of the 
\begin_inset Formula $\ell_{2}$
\end_inset

 and 
\begin_inset Formula $\ell_{\infty}$
\end_inset

 errors for the solid body rotation test case on orthogonal and non-orthogonal
 grids using multi-dimensional and dimensionally split schemes.
 
\begin_inset CommandInset label
LatexCommand label
name "fig:solidBodyConverge"

\end_inset

 
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Deformational Flow
\end_layout

\begin_layout Standard
Unlike solid body rotation test case, in deformational flow, it is difficult
 to resolve the analytical solution and the deformational flow test case
 is more challenging than solid body rotation test case.
 The test case is devised by 
\begin_inset CommandInset citation
LatexCommand citet
key "LSPT2012"

\end_inset

 to set up a universal test case for advection schemes under spherical coordinat
es, which modified the streamfunction using the techenique by 
\begin_inset CommandInset citation
LatexCommand citet
key "Nair2010"

\end_inset

.
 The streamfunction can effectively calculate the error norms and order
 of accuracy of the schemes in this test case by making the velocity field
 reverse the flow half way through with a uniform background velocity field.
 
\end_layout

\begin_layout Standard
The Cartesian version of this test case has a domain between 0 and 
\begin_inset Formula $2\pi\text{ m}$
\end_inset

 in the 
\begin_inset Formula $x$
\end_inset

 direction (
\begin_inset Formula $L_{x}=2\pi\text{ m}$
\end_inset

) and between 
\begin_inset Formula $-\frac{\pi}{2}\text{ m}$
\end_inset

 and 
\begin_inset Formula $\frac{\pi}{2}\text{ m}$
\end_inset

 in the 
\begin_inset Formula $y$
\end_inset

 direction (
\begin_inset Formula $L_{y}=\pi\text{ m}$
\end_inset

) with periodic boundary conditions in the 
\begin_inset Formula $x$
\end_inset

 direction and zero gradient boundary conditions in the 
\begin_inset Formula $y$
\end_inset

 direction.
 The stream function for adapted to Cartesian coordinate is:
\begin_inset Formula 
\begin{eqnarray}
\psi\left(x,y,t\right) & = & \frac{\hat{\psi}}{T}\left(\frac{L_{x}}{2\pi}\right)^{2}\sin^{2}\left(2\pi\left(\frac{x}{L_{x}}-\frac{t}{T}\right)\right)\cos^{2}\left(\pi\frac{y}{L_{y}}\right)\cos\left(\pi\frac{t}{T}\right)-L_{x}\frac{y}{T}
\end{eqnarray}

\end_inset

where 
\begin_inset Formula $\hat{\psi}=10$
\end_inset

 and 
\begin_inset Formula $T=5\text{ s}$
\end_inset

 is the time for one complete revolution of the periodic domain for the
 solid body rotation part of the flow.
 In order to test the order of accuracy of the advection schemes, we use
 the infinitely smooth Gaussian distribution for the initial tracer concentratio
n:
\begin_inset Formula 
\begin{equation}
\phi=0.95\exp-\frac{|\mathbf{x}-\mathbf{x}_{0}|^{2}}{A}+0.95\exp-\frac{|\mathbf{x}-\mathbf{x}_{1}|^{2}}{A}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{x}^{T}=(x,y)$
\end_inset

, 
\begin_inset Formula $\mathbf{x}_{0}^{T}=(\frac{5}{12}L_{x},0)$
\end_inset

, 
\begin_inset Formula $\mathbf{x}_{1}^{T}=(\frac{7}{12}L_{x},0)$
\end_inset

 and 
\begin_inset Formula $A=\frac{1}{5}\text{ m}^{2}$
\end_inset

.
\end_layout

\begin_layout Standard
A less distorted grid is used in deformational flow test case since a distorted
 grid used in solid body rotation test case can result in unstable numerical
 scheme in more challenging test case.
 Further, the grid halves the slope of the grid in solid body rotation and
 can be defined as follows:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\begin{array}{ccc}
X=x &  & Y=\begin{cases}
y_{max}\frac{y_{c}-f}{y_{max}-f} & \text{ for }y\ge f\\
y_{min}\frac{y_{c}-f}{y_{min}-f} & \text{ for }y<f
\end{cases}\end{array}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
where 
\begin_inset Formula $y_{c}$
\end_inset

 represent the computational domain, and the 
\begin_inset Formula $f$
\end_inset

 is:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
f=\begin{cases}
y_{m}+\frac{x_{m}}{4\sqrt{3}}-\frac{x}{2\sqrt{3}} & \text{ for }x\le x_{m}\\
y_{m}-\frac{x_{m}}{4\sqrt{3}}-\frac{x-x_{m}}{2\sqrt{3}} & \text{ for }x>x_{m}
\end{cases}.
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
where 
\begin_inset Formula $x_{m}=\pi$
\end_inset

 is the midpoint of x-direction and 
\begin_inset Formula $y_{m}=0$
\end_inset

 is the midpoint of y-direction.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename HilarysGraphics/deformingAdvection_nonOrthog_120x60_0_Tmesh.pdf
	width 100text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Graphics
	filename HilarysGraphics/deformingAdvection_legends_Tmesh_T.pdf
	width 100text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
The non-orthognal grid/co-ordinate system for the deformational flow with
 
\begin_inset Formula $120\times60$
\end_inset

 cells and the initial tracer conditions.
\begin_inset CommandInset label
LatexCommand label
name "fig:deformGrid"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="7" columns="2">
<features tabularvalignment="middle">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $t=0$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $t=1$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Graphics
	filename HilarysGraphics/deformingAdvection_orthogonal_1600x800_0_T.png
	lyxscale 25
	width 49text%

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Graphics
	filename HilarysGraphics/deformingAdvection_orthogonal_1600x800_1_T.png
	lyxscale 25
	width 49text%

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $t=2$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $t=3$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Graphics
	filename HilarysGraphics/deformingAdvection_orthogonal_1600x800_2_T.png
	lyxscale 25
	width 49text%

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Graphics
	filename HilarysGraphics/deformingAdvection_orthogonal_1600x800_3_T.png
	lyxscale 25
	width 49text%

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $t=4$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $t=5$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Graphics
	filename HilarysGraphics/deformingAdvection_orthogonal_1600x800_4_T.png
	lyxscale 25
	width 49text%

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Graphics
	filename HilarysGraphics/deformingAdvection_orthogonal_1600x800_5_T.png
	lyxscale 25
	width 49text%

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell multicolumn="1" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Graphics
	filename HilarysGraphics/deformingAdvection_legends_T.pdf
	width 98text%

\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Results of the deformational flow test case after 0, 1, 2, 3, 4 and 5 seconds.
 Contour intervals every 0.1 at ...,-0.05, 0.05, 0.15, 0.25,...
 The results shown use the multi-dimensional scheme on an orthogonal grid
 of 
\begin_inset Formula $1600\times800$
\end_inset

 cells.
 
\begin_inset CommandInset label
LatexCommand label
name "fig:deformResults"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename HilarysGraphics/deformingAdvection_plots_l2errors.pdf
	width 48line%

\end_inset


\begin_inset Graphics
	filename HilarysGraphics/deformingAdvection_plots_linferrors.pdf
	width 48line%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Convergence with resolution of the 
\begin_inset Formula $\ell_{2}$
\end_inset

 and 
\begin_inset Formula $\ell_{\infty}$
\end_inset

 errors for the deformational flow on orthogonal and non-orthogonal grids
 using multi-dimensional and dimensionally split schemes.
 
\begin_inset CommandInset label
LatexCommand label
name "fig:deformationalConverge"

\end_inset

 
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Horizontal Advection over Orography
\end_layout

\begin_layout Standard
The dimensionally splitting schemes are designed for orthogonal grids.
 In order to adjust the scheme for non-orthogonal grids, a Jacobian described
 by 
\begin_inset CommandInset citation
LatexCommand citet
key "Schar2002"

\end_inset

 should be applied in the dimensionally splitting scheme.
 
\end_layout

\begin_layout Standard
Horizontal advection over orography 
\begin_inset CommandInset citation
LatexCommand citep
key "SLF+02"

\end_inset

 using a basic terrain following (BTF) grid (with mesh layers at the heights
 of the BTF coordinates.
 Numerical solution of the advection equation
\begin_inset Formula 
\begin{equation}
\frac{\partial\phi}{\partial t}+\nabla\cdot\mathbf{u}\phi=0
\end{equation}

\end_inset

for 
\begin_inset Formula $\phi$
\end_inset

 where 
\begin_inset Formula $\mathbf{u}$
\end_inset

 is the divergence free velocity prescribed from a streamfunction.
 
\end_layout

\begin_layout Standard
The properties of multi-dimensional scheme and dimensionally split scheme
 not only rely on the spatial resolution, but also the temporal resolution.
 The sensitivity of dimensionally split scheme and multi-dimensional scheme
 to the temporal resolution with the same spatial resolution can give an
 insight of the differences between these schemes, which is shown in figure
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:horizontalAdvectionWithDt"

\end_inset

.
 Compared with multi-dimensional scheme, the dimensionally split scheme
 shows smaller error at final time when 
\begin_inset Formula $\Delta t$
\end_inset

 is less than 100, where the deformational Courant number is less than one.
 It also can be seen that the shape of the tracer is distorted more severely
 in the dimensionally split scheme than the multi-dimensional scheme, though
 the error does not get larger, when t = 5000 s at which time the tracer
 advected over the top of the mountain with highest non-orthogonality.
 This exposes the shortcomings of dimensionally split scheme.
 With time-steps larger than 100 s, where the deformational Courant number
 starts to get larger than one, the dimensionally split scheme performs
 much worse than multi-dimensional scheme and eventually become unstable.
 Although suffering severe phase error due to its implicit time-stepping,
 the multi-dimensional scheme is still stable.
 Hence, the dimensionally split scheme is more accurate than multi-dimensional
 scheme until the deformational Courant number become larger than one.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="8" columns="3">
<features tabularvalignment="middle" tabularwidth="100line%">
<column alignment="center" valignment="middle" width="14text%">
<column alignment="center" valignment="top" width="42text%">
<column alignment="center" valignment="top" width="0">
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Dimensionally split
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Multi-dimensional
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Delta t=25\ $
\end_inset

s
\end_layout

\begin_layout Plain Layout
max 
\begin_inset Formula $c$
\end_inset

 = 0.74
\end_layout

\begin_layout Plain Layout
mode 
\begin_inset Formula $c$
\end_inset

 =0.2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Graphics
	filename YumengsGraphics/vSlice_horizontalAdvection_orography_save_cubicUpwindCPCFit_dt25CN_up_10000_Tall.pdf
	lyxscale 50
	width 39text%
	height 20text%
	BoundingBox 0bp 0bp 449bp 255bp
	clip
	special valign=m

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Graphics
	filename HilarysGraphics/vSlice_horizontalAdvection_orography_save_cubicUpwindCPCFit_dt25CN_up_10000_Tall.pdf
	lyxscale 50
	width 42text%
	special valign=m

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Delta t=50\ $
\end_inset

s
\end_layout

\begin_layout Plain Layout
max 
\begin_inset Formula $c$
\end_inset

 = 1.48
\end_layout

\begin_layout Plain Layout
mode 
\begin_inset Formula $c$
\end_inset

 =0.4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Graphics
	filename YumengsGraphics/vSlice_horizontalAdvection_orography_save_cubicUpwindCPCFit_dt50CN_up_10000_Tall.pdf
	lyxscale 50
	width 39text%
	height 20text%
	BoundingBox 0bp 0bp 449bp 255bp
	clip
	special valign=m

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Graphics
	filename HilarysGraphics/vSlice_horizontalAdvection_orography_save_cubicUpwindCPCFit_dt50CN_up_10000_Tall.pdf
	lyxscale 50
	width 42text%
	special valign=m

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Delta t=100\ $
\end_inset

s
\end_layout

\begin_layout Plain Layout
max 
\begin_inset Formula $c$
\end_inset

 = 2.96
\end_layout

\begin_layout Plain Layout
mode 
\begin_inset Formula $c$
\end_inset

 =0.8
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Graphics
	filename YumengsGraphics/vSlice_horizontalAdvection_orography_save_cubicUpwindCPCFit_dt100CN_up_10000_Tall.pdf
	lyxscale 50
	width 39text%
	height 20text%
	BoundingBox 0bp 0bp 449bp 255bp
	clip
	special valign=m

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Graphics
	filename HilarysGraphics/vSlice_horizontalAdvection_orography_save_cubicUpwindCPCFit_dt100CN_up_10000_Tall.pdf
	lyxscale 50
	width 42text%
	special valign=m

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Delta t=200\ $
\end_inset

s
\end_layout

\begin_layout Plain Layout
max 
\begin_inset Formula $c$
\end_inset

 = 5.93
\end_layout

\begin_layout Plain Layout
mode 
\begin_inset Formula $c$
\end_inset

 =1.6
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Graphics
	filename YumengsGraphics/vSlice_horizontalAdvection_orography_save_cubicUpwindCPCFit_dt200CN_up_10000_Tall.pdf
	lyxscale 50
	width 39text%
	height 20text%
	BoundingBox 0bp 0bp 449bp 255bp
	clip
	special valign=m

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Graphics
	filename HilarysGraphics/vSlice_horizontalAdvection_orography_save_cubicUpwindCPCFit_dt200CN_up_10000_Tall.pdf
	lyxscale 50
	width 42text%
	special valign=m

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Delta t=500\ $
\end_inset

s
\end_layout

\begin_layout Plain Layout
max 
\begin_inset Formula $c$
\end_inset

 = 14.8
\end_layout

\begin_layout Plain Layout
mode 
\begin_inset Formula $c$
\end_inset

 =4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Graphics
	filename YumengsGraphics/vSlice_horizontalAdvection_orography_save_cubicUpwindCPCFit_dt500CN_up_10000_Tall.pdf
	lyxscale 50
	width 39text%
	height 20text%
	BoundingBox 0bp 0bp 449bp 255bp
	clip
	special valign=m

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Graphics
	filename HilarysGraphics/vSlice_horizontalAdvection_orography_save_cubicUpwindCPCFit_dt500CN_up_10000_Tall.pdf
	lyxscale 50
	width 42text%
	special valign=m

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Delta t=1000\ $
\end_inset

s
\end_layout

\begin_layout Plain Layout
max 
\begin_inset Formula $c$
\end_inset

 = 29.6
\end_layout

\begin_layout Plain Layout
mode 
\begin_inset Formula $c$
\end_inset

 =8
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Graphics
	filename YumengsGraphics/vSlice_horizontalAdvection_orography_save_cubicUpwindCPCFit_dt1000CN_up_10000_Tall.pdf
	lyxscale 50
	width 39text%
	height 20text%
	BoundingBox 0bp 0bp 449bp 255bp
	clip
	special valign=m

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Graphics
	filename HilarysGraphics/vSlice_horizontalAdvection_orography_save_cubicUpwindCPCFit_dt1000CN_up_10000_Tall.pdf
	lyxscale 50
	width 42text%
	special valign=m

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell multicolumn="1" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Graphics
	filename HilarysGraphics/vSlice_horizontalAdvection_orography_legends_Tall_TdiffAll.pdf
	lyxscale 50
	width 85text%

\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Tracer contours after 0, 5000 and 10000s for the horizontal advection over
 orography and errors in colour.
 Different plots use different time-steps.
 Spatial resolution is 
\begin_inset Formula $\Delta x=1\ $
\end_inset

km, 
\begin_inset Formula $\Delta z=500\ $
\end_inset

m.
 Maximum and mode Courant numbers, 
\begin_inset Formula $c$
\end_inset

, given above figures.
 The mode Courant number is defined to be the Courant number without the
 presence of orography 
\begin_inset CommandInset label
LatexCommand label
name "fig:horizontalAdvectionWithDt"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Dimensionally split scheme has first order error on non-orthogonal grids
 while multi-dimensional scheme can preserve its order of accuracy on various
 grids.
 The convergence rate of these two schemes on BTF, which is widely used
 in operational weather forecaseting models, is of interest.
 The results of these two schemes with the same mode Courant number of 0.2
 is shown in figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:horizontalAdvectionWithDx"

\end_inset

.
 The dimensionally split scheme is more distorted than the multi-dimensonal
 scheme.
 With finer resolution, both schemes get better results, while the multi-dimensi
onal scheme is less diffusive and shows smaller error than dimensionally
 scheme.
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="3">
<features tabularvalignment="middle" tabularwidth="100line%">
<column alignment="center" valignment="middle" width="14text%">
<column alignment="center" valignment="top" width="42text%">
<column alignment="center" valignment="top" width="0">
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Dimensionally split
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Multi-dimensional
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Delta x=2\ $
\end_inset

km
\end_layout

\begin_layout Plain Layout
\begin_inset Formula $\Delta z=1\ $
\end_inset

km
\end_layout

\begin_layout Plain Layout
\begin_inset Formula $\Delta t=50\ $
\end_inset

s
\end_layout

\begin_layout Plain Layout
max 
\begin_inset Formula $c$
\end_inset

 = 0.59
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Graphics
	filename YumengsGraphics/vSlice_horizontalAdvection_orography_coarse_save_cubicUpwindCPCFit_dt50CN_up_10000_Tall.pdf
	lyxscale 50
	width 39text%
	height 20text%
	BoundingBox 0bp 0bp 449bp 255bp
	clip
	special valign=m

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Graphics
	filename HilarysGraphics/vSlice_horizontalAdvection_orography_coarse_save_cubicUpwindCPCFit_dt50CN_up_10000_Tall.pdf
	lyxscale 50
	width 42text%
	special valign=m

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Delta x=1\ $
\end_inset

km
\end_layout

\begin_layout Plain Layout
\begin_inset Formula $\Delta z=500\ $
\end_inset

m
\end_layout

\begin_layout Plain Layout
\begin_inset Formula $\Delta t=25\ $
\end_inset

s
\end_layout

\begin_layout Plain Layout
max 
\begin_inset Formula $c$
\end_inset

 = 0.74
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Graphics
	filename YumengsGraphics/vSlice_horizontalAdvection_orography_save_cubicUpwindCPCFit_dt25CN_up_10000_Tall.pdf
	lyxscale 50
	width 39text%
	height 20text%
	BoundingBox 0bp 0bp 449bp 255bp
	clip
	special valign=m

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Graphics
	filename HilarysGraphics/vSlice_horizontalAdvection_orography_save_cubicUpwindCPCFit_dt25CN_up_10000_Tall.pdf
	lyxscale 50
	width 42text%
	special valign=m

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Delta x=500\ $
\end_inset

m
\end_layout

\begin_layout Plain Layout
\begin_inset Formula $\Delta z=250\ $
\end_inset

m
\end_layout

\begin_layout Plain Layout
\begin_inset Formula $\Delta t=12.5\ $
\end_inset

s
\end_layout

\begin_layout Plain Layout
max 
\begin_inset Formula $c$
\end_inset

 = 0.78
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Graphics
	filename YumengsGraphics/vSlice_horizontalAdvection_orography_fine_save_cubicUpwindCPCFit_dt12.5CN_up_10000_Tall.pdf
	lyxscale 50
	width 39text%
	height 20text%
	BoundingBox 0bp 0bp 449bp 255bp
	clip
	special valign=m

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Graphics
	filename HilarysGraphics/vSlice_horizontalAdvection_orography_fine_save_cubicUpwindCPCFit_dt12.5CN_up_10000_Tall.pdf
	lyxscale 50
	width 42text%
	special valign=m

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Delta x=250\ $
\end_inset

m
\end_layout

\begin_layout Plain Layout
\begin_inset Formula $\Delta z=125\ $
\end_inset

m
\end_layout

\begin_layout Plain Layout
\begin_inset Formula $\Delta t=6.25\ $
\end_inset

s
\end_layout

\begin_layout Plain Layout
max 
\begin_inset Formula $c$
\end_inset

 = 0.78
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Graphics
	filename YumengsGraphics/vSlice_horizontalAdvection_orography_vfine_save_cubicUpwindCPCFit_dt6.25CN_up_10000_Tall.pdf
	lyxscale 50
	width 39text%
	height 20text%
	BoundingBox 0bp 0bp 449bp 255bp
	clip
	special valign=m

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Graphics
	filename HilarysGraphics/vSlice_horizontalAdvection_orography_vfine_save_cubicUpwindCPCFit_dt6.25CN_up_10000_Tall.pdf
	lyxscale 50
	width 42text%
	special valign=m

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell multicolumn="1" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Graphics
	filename HilarysGraphics/vSlice_horizontalAdvection_orography_legends_Tall_TdiffAll.pdf
	lyxscale 50
	width 85text%

\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Tracer contours after 0, 5000 and 10000s for the horizontal advection over
 orography and errors in colour.
 Different plots use different spatial and temporal resolutions but they
 use the same horizontal (mode) Courant number of 0.2.
 The maximum Courant number is dependent on the resolution of the orography.
 
\begin_inset CommandInset label
LatexCommand label
name "fig:horizontalAdvectionWithDx"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The convergence rate with resolution of mountain of both 3000m and 6000m
 using 
\begin_inset Formula $\ell_{2}$
\end_inset

 and 
\begin_inset Formula $\ell_{\infty}$
\end_inset

 error norm measured by grids of 
\begin_inset Formula $150\times25$
\end_inset

, 
\begin_inset Formula $300\times50$
\end_inset

, 
\begin_inset Formula $600\times100$
\end_inset

, 
\begin_inset Formula $1200\times200$
\end_inset

 and 
\begin_inset Formula $1500\times250$
\end_inset

 cells with time-steps scaled in order to maintain the same mode Courant
 numbers of 
\begin_inset Formula $2.0$
\end_inset

 (
\begin_inset Formula $\Delta t=50,\ 25,\ 12.5,\ 6.25,\ 5.0\text{ s}$
\end_inset

 ) in figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:horizontalAdvectConverge"

\end_inset

.
 Under coarse resolution, the dimensionally split scheme and multi-dimensional
 scheme has similar accuracy and convergence rate, because the non-orthogonality
 is not the dominating error on coarse resolution.
 With finer resolution, the order of convergence rate of dimensionally split
 reduce to first order, whereas the multi-dimensional scheme is still second
 order accurate.
 As the horizontal resolution less than 
\begin_inset Formula $250$
\end_inset

m, the multi-dimensional scheme outperforms the dimensionally split scheme
 due to the ability to resolve the non-orthogonal grid.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename HilarysGraphics/orography_l2errors.eps
	width 100text%

\end_inset


\end_layout

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename HilarysGraphics/orography_linferrors.eps
	width 100text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Convergence of the 
\begin_inset Formula $\ell_{2}$
\end_inset

 and 
\begin_inset Formula $\ell_{\infty}$
\end_inset

 error metrics for horizontal advection over a 3000m and a 6000m mountains
 after 10,000s for the dimensionally split (PPM) scheme and multi-dimensional
 MOL scheme using the results shown in figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:horizontalAdvectionWithDx"

\end_inset

, all using a horizontal Courant number of 0.2.
 Lines also show theoretical first- and second-order convergence are also
 shown.
 
\begin_inset CommandInset label
LatexCommand label
name "fig:horizontalAdvectConverge"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Section
Discussion and Conclusions
\end_layout

\begin_layout Standard
\begin_inset CommandInset bibtex
LatexCommand bibtex
bibfiles "numerics,reference"
options "abbrvnat"

\end_inset


\end_layout

\end_body
\end_document
